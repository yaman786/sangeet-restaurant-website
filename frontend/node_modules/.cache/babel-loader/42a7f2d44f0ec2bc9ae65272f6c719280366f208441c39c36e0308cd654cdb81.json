{"ast":null,"code":"import _objectSpread from\"/Users/amanrana/Desktop/sangeet_restaurant_fresh/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{motion}from'framer-motion';import{useNavigate}from'react-router-dom';import{isNewItem,getTimeSinceAdded,sortItemsByNewness,hasMultipleSessions}from'../utils/itemUtils';import{updateOrderStatus,deleteOrder,bulkUpdateOrderStatus,searchOrders,fetchTables,getOrderById}from'../services/api';import toast from'react-hot-toast';import AdminHeader from'../components/AdminHeader';import socketService from'../services/socketService';import CustomDropdown from'../components/CustomDropdown';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminOrdersPage=()=>{// eslint-disable-next-line no-unused-vars\nconst navigate=useNavigate();const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[selectedOrders,setSelectedOrders]=useState([]);const[filters,setFilters]=useState({status:'',table_id:'',date_from:'',date_to:'',query:''});const[tables,setTables]=useState([]);const[viewMode,setViewMode]=useState('all');// all, pending, preparing, ready, completed\nconst[completedOrders,setCompletedOrders]=useState([]);// Track completed orders separately\nconst[selectedOrderDetails,setSelectedOrderDetails]=useState(null);const[showOrderModal,setShowOrderModal]=useState(false);const[deleteModal,setDeleteModal]=useState({isOpen:false,orderId:null,orderNumber:null,customerName:null,tableNumber:null});const[activeOrdersModal,setActiveOrdersModal]=useState({isOpen:false,customerName:null,activeOrders:[],blockedOrderId:null});const statusOptions=[{value:'pending',label:'Pending'},{value:'preparing',label:'Preparing'},{value:'ready',label:'Ready'},{value:'completed',label:'Completed'},{value:'cancelled',label:'Cancelled'}];const loadDashboardData=async()=>{try{setLoading(true);// Load orders based on filters and view mode\nlet searchParams=_objectSpread({},filters);if(viewMode!=='all'){searchParams.status=viewMode;}const[ordersData,tablesData]=await Promise.all([searchOrders(searchParams),fetchTables()]);// Separate completed orders from active orders\nconst activeOrders=(ordersData||[]).filter(order=>order.status!=='completed');const completedOrders=(ordersData||[]).filter(order=>order.status==='completed');setOrders(activeOrders);setCompletedOrders(completedOrders);setTables(tablesData);}catch(error){console.error('Error loading dashboard data:',error);toast.error('Failed to load dashboard data');}finally{setLoading(false);}};// Data loading useEffect - ALWAYS RUN\nuseEffect(()=>{loadDashboardData();// eslint-disable-line react-hooks/exhaustive-deps\n},[filters,viewMode]);// eslint-disable-line react-hooks/exhaustive-deps\n// Socket setup for realtime updates - minimal: reload on any event\nuseEffect(()=>{try{if(!socketService.isConnected){socketService.connect();}socketService.joinAdminRoom();const handleNewOrder=()=>{toast.success('New order received');loadDashboardData();};const handleStatusUpdate=data=>{loadDashboardData();};const handleOrderDeleted=data=>{loadDashboardData();};socketService.onNewOrder(handleNewOrder);socketService.onOrderStatusUpdate(handleStatusUpdate);socketService.onOrderDeleted(handleOrderDeleted);return()=>{socketService.removeListener('new-order');socketService.removeListener('order-status-update');socketService.removeListener('order-deleted');};}catch(error){console.error('Error setting up socket:',error);}},[]);// Validate status transitions to prevent backward movement\nconst isValidStatusTransition=(currentStatus,newStatus)=>{var _statusFlow$currentSt;const statusFlow={'pending':['preparing','cancelled'],'preparing':['ready','cancelled'],'ready':['completed','cancelled'],'completed':[],// No further transitions allowed\n'cancelled':[]// No further transitions allowed\n};return((_statusFlow$currentSt=statusFlow[currentStatus])===null||_statusFlow$currentSt===void 0?void 0:_statusFlow$currentSt.includes(newStatus))||false;};// Check if order can be completed (no other active orders for same customer)\nconst canCompleteOrder=order=>{// Check if customer has other active orders\nconst otherActiveOrders=orders.filter(o=>o.id!==order.id&&o.customer_name===order.customer_name&&o.status!=='completed'&&o.status!=='cancelled');return otherActiveOrders.length===0;};// Get other active orders for a customer\nconst getOtherActiveOrders=order=>{return orders.filter(o=>o.id!==order.id&&o.customer_name===order.customer_name&&o.status!=='completed'&&o.status!=='cancelled');};// Show active orders modal\nconst showActiveOrdersModal=order=>{const otherActiveOrders=getOtherActiveOrders(order);setActiveOrdersModal({isOpen:true,customerName:order.customer_name,activeOrders:otherActiveOrders,blockedOrderId:order.id});};// Close active orders modal\nconst closeActiveOrdersModal=()=>{setActiveOrdersModal({isOpen:false,customerName:null,activeOrders:[],blockedOrderId:null});};const handleStatusUpdate=async(orderId,newStatus)=>{try{// Find the current order to get its status\nconst currentOrder=orders.find(order=>order.id===orderId)||completedOrders.find(order=>order.id===orderId);if(!currentOrder){toast.error('Order not found');return;}// Validate status transition\nif(!isValidStatusTransition(currentOrder.status,newStatus)){toast.error(\"Cannot change status from \\\"\".concat(currentOrder.status,\"\\\" to \\\"\").concat(newStatus,\"\\\". Invalid transition.\"));return;}await updateOrderStatus(orderId,newStatus);toast.success('Order status updated successfully');// Don't reload data since socket will handle the update\n}catch(error){var _error$response,_error$response$data,_error$response$data$;console.error('Error updating order status:',error);// Handle specific error for active orders\nif((_error$response=error.response)!==null&&_error$response!==void 0&&(_error$response$data=_error$response.data)!==null&&_error$response$data!==void 0&&(_error$response$data$=_error$response$data.error)!==null&&_error$response$data$!==void 0&&_error$response$data$.includes('other active orders')){const activeOrders=error.response.data.activeOrders;const customerName=error.response.data.customerName;// Show detailed error with active orders list\ntoast.error(\"Cannot complete order. \".concat(customerName,\" has other active orders.\"),{duration:8000});// Show active orders details\nconst activeOrdersList=activeOrders.map(order=>\"Order #\".concat(order.order_number,\" (\").concat(order.status,\")\")).join(', ');toast.success(\"Active orders: \".concat(activeOrdersList),{duration:10000});}else{toast.error('Failed to update order status');}}};const handleDeleteOrder=async orderId=>{// Find the order details to show in modal\nconst orderToDelete=orders.find(order=>order.id===orderId)||completedOrders.find(order=>order.id===orderId);if(orderToDelete){setDeleteModal({isOpen:true,orderId:orderId,orderNumber:orderToDelete.order_number||orderId,customerName:orderToDelete.customer_name,tableNumber:orderToDelete.table_number});}};const confirmDeleteOrder=async()=>{try{await deleteOrder(deleteModal.orderId);toast.success('Order deleted successfully');setDeleteModal({isOpen:false,orderId:null,orderNumber:null,customerName:null,tableNumber:null});// Fallback: reload data after a short delay if socket doesn't work\nsetTimeout(()=>{loadDashboardData();},1000);}catch(error){toast.error('Failed to delete order');}};const cancelDeleteOrder=()=>{setDeleteModal({isOpen:false,orderId:null,orderNumber:null,customerName:null,tableNumber:null});};const handleViewOrderDetails=async orderId=>{try{const orderDetails=await getOrderById(orderId);setSelectedOrderDetails(orderDetails);setShowOrderModal(true);}catch(error){console.error('Error fetching order details:',error);toast.error('Failed to load order details');}};const handleBulkStatusUpdate=async status=>{if(selectedOrders.length===0){toast.error('Please select orders to update');return;}try{await bulkUpdateOrderStatus(selectedOrders,status);toast.success(\"\".concat(selectedOrders.length,\" orders updated successfully\"));setSelectedOrders([]);// Don't reload data since socket will handle the updates\n}catch(error){toast.error('Failed to bulk update orders');}};const handleClearCompletedOrders=()=>{// Show confirmation dialog\nconst confirmed=window.confirm('Clear completed orders from screen? (Data will be kept for analytics)');if(!confirmed){return;}// Clear completed orders from local state only (keep in database)\nsetCompletedOrders([]);toast.success('Completed orders cleared from screen');};const handleOrderSelection=orderId=>{// Find the order to check its status\nconst order=orders.find(o=>o.id===orderId)||completedOrders.find(o=>o.id===orderId);// Prevent selection of completed or cancelled orders\nif(order&&(order.status==='completed'||order.status==='cancelled')){toast.error('Cannot select completed or cancelled orders for bulk actions');return;}setSelectedOrders(prev=>prev.includes(orderId)?prev.filter(id=>id!==orderId):[...prev,orderId]);};const handleSelectAll=()=>{const currentOrders=viewMode==='completed'?completedOrders:orders;// Filter out completed and cancelled orders from bulk selection\nconst selectableOrders=currentOrders.filter(order=>order.status!=='completed'&&order.status!=='cancelled');if(selectedOrders.length===selectableOrders.length){setSelectedOrders([]);}else{setSelectedOrders(selectableOrders.map(order=>order.id));}};const getStatusColor=status=>{const colors={pending:'bg-yellow-500',confirmed:'bg-blue-500',preparing:'bg-orange-500',ready:'bg-green-500',completed:'bg-gray-500',cancelled:'bg-red-500'};return colors[status]||'bg-gray-500';};const formatDate=dateString=>{return new Date(dateString).toLocaleString();};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-sangeet-neutral-950 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-400\",children:\"Loading admin dashboard...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-sangeet-neutral-950\",children:[/*#__PURE__*/_jsx(AdminHeader,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-900/20 border border-blue-500/30 rounded-xl p-4 mb-6 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-400 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-300 text-sm\",children:\"\\uD83D\\uDD04 Order list updates automatically in real-time\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-xl p-6 mb-6 border border-sangeet-neutral-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mb-4\",children:[['all','pending','preparing','ready','completed'].map(mode=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setViewMode(mode),className:\"px-4 py-2 rounded-lg text-sm font-medium transition-all \".concat(viewMode===mode?'bg-sangeet-400 text-sangeet-neutral-950':'bg-sangeet-neutral-800 text-sangeet-neutral-400 hover:bg-sangeet-neutral-700'),children:[mode.charAt(0).toUpperCase()+mode.slice(1),mode==='completed'&&completedOrders.length>0&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-1 bg-sangeet-neutral-700 text-sangeet-neutral-300 px-1.5 py-0.5 rounded-full text-xs\",children:completedOrders.length})]},mode)),viewMode==='completed'&&completedOrders.length>0&&/*#__PURE__*/_jsx(\"button\",{onClick:handleClearCompletedOrders,className:\"px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition-colors\",children:\"Clear\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search by customer name or order number...\",value:filters.query,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{query:e.target.value})),className:\"w-full px-4 py-2 bg-sangeet-neutral-800 border border-sangeet-neutral-700 rounded-lg text-sangeet-neutral-300 focus:outline-none focus:border-sangeet-400\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CustomDropdown,{value:filters.table_id,onChange:tableId=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{table_id:tableId})),options:[{value:'',label:'All Tables'},...tables.map(table=>({value:table.id,label:\"Table \".concat(table.table_number)}))],className:\"w-full\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sangeet-neutral-400 text-sm mb-2\",children:\"From Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:filters.date_from,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{date_from:e.target.value})),className:\"w-full px-4 py-2 bg-sangeet-neutral-800 border border-sangeet-neutral-700 rounded-lg text-sangeet-neutral-300 focus:outline-none focus:border-sangeet-400 [&::-webkit-calendar-picker-indicator]:filter [&::-webkit-calendar-picker-indicator]:invert [&::-webkit-calendar-picker-indicator]:brightness-0 [&::-webkit-calendar-picker-indicator]:contrast-200\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sangeet-neutral-400 text-sm mb-2\",children:\"To Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:filters.date_to,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{date_to:e.target.value})),className:\"w-full px-4 py-2 bg-sangeet-neutral-800 border border-sangeet-neutral-700 rounded-lg text-sangeet-neutral-300 focus:outline-none focus:border-sangeet-400 [&::-webkit-calendar-picker-indicator]:filter [&::-webkit-calendar-picker-indicator]:invert [&::-webkit-calendar-picker-indicator]:brightness-0 [&::-webkit-calendar-picker-indicator]:contrast-200\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-end\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setFilters({status:'',table_id:'',date_from:'',date_to:'',query:''}),className:\"w-full px-4 py-2 bg-sangeet-neutral-700 text-sangeet-neutral-300 rounded-lg hover:bg-sangeet-neutral-600 transition-colors\",children:\"Clear Filters\"})})]})]}),selectedOrders.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-xl p-4 mb-6 border border-sangeet-neutral-700\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sangeet-neutral-400\",children:[selectedOrders.length,\" order(s) selected\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-sangeet-neutral-500 mt-1\",children:\"\\uD83D\\uDCA1 Completed and cancelled orders cannot be modified\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:['preparing','ready','completed','cancelled'].map(status=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleBulkStatusUpdate(status),className:\"px-3 py-1 bg-sangeet-400 text-sangeet-neutral-950 rounded text-sm font-medium hover:bg-sangeet-300 transition-colors\",children:[\"Mark \",status.charAt(0).toUpperCase()+status.slice(1)]},status))})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-xl border border-sangeet-neutral-700 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-sangeet-neutral-800\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:(()=>{const currentOrders=viewMode==='completed'?completedOrders:orders;const selectableOrders=currentOrders.filter(order=>order.status!=='completed'&&order.status!=='cancelled');return selectedOrders.length===selectableOrders.length&&selectableOrders.length>0;})(),onChange:handleSelectAll,className:\"rounded border-sangeet-neutral-600 bg-sangeet-neutral-800 text-sangeet-400 focus:ring-sangeet-400\"})}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\",children:\"Order #\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\",children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\",children:\"Table\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-sangeet-neutral-700\",children:(viewMode==='completed'?completedOrders:orders).map(order=>/*#__PURE__*/_jsxs(motion.tr,{initial:{opacity:0},animate:{opacity:1},className:\"hover:bg-sangeet-neutral-800 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedOrders.includes(order.id),onChange:()=>handleOrderSelection(order.id),disabled:order.status==='completed'||order.status==='cancelled',className:\"rounded border-sangeet-neutral-600 focus:ring-sangeet-400 \".concat(order.status==='completed'||order.status==='cancelled'?'bg-sangeet-neutral-700 text-sangeet-neutral-500 cursor-not-allowed':'bg-sangeet-neutral-800 text-sangeet-400'),title:order.status==='completed'||order.status==='cancelled'?\"Cannot select \".concat(order.status,\" orders for bulk actions\"):'Select for bulk actions'})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sangeet-400 font-medium\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:order.order_number}),order.items&&hasMultipleSessions(order.items)&&/*#__PURE__*/_jsx(\"span\",{className:\"bg-blue-500 text-white px-1 py-0.5 rounded text-xs font-medium\",title:\"Merged Order\",children:\"\\uD83D\\uDD04\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sangeet-neutral-300\",children:order.customer_name}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 text-sangeet-neutral-300\",children:[\"Table \",order.table_number]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 text-sangeet-400 font-medium\",children:[\"$\",order.total_amount]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-medium text-white \".concat(getStatusColor(order.status),\" transition-all duration-300\"),children:order.status.charAt(0).toUpperCase()+order.status.slice(1)}),order.updated_at&&order.updated_at!==order.created_at&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-sangeet-neutral-500 mt-1\",children:[\"Updated: \",formatDate(order.updated_at)]}),order.updated_at&&order.updated_at!==order.created_at&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1 -right-1 w-2 h-2 bg-green-400 rounded-full animate-ping\"}),(order.status==='completed'||order.status==='cancelled')&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1 -left-1 w-3 h-3 bg-sangeet-neutral-600 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"\\uD83D\\uDD12\"})})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sangeet-neutral-400 text-sm\",children:formatDate(order.created_at)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(CustomDropdown,{value:order.status,onChange:newStatus=>handleStatusUpdate(order.id,newStatus),options:statusOptions,className:\"text-xs \".concat(order.status==='completed'||order.status==='cancelled'?'opacity-50 cursor-not-allowed':''),disabled:order.status==='completed'||order.status==='cancelled'}),(order.status==='completed'||order.status==='cancelled')&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1 -right-1 w-4 h-4 bg-sangeet-neutral-600 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"\\uD83D\\uDD12\"})}),!canCompleteOrder(order)&&order.status!=='completed'&&order.status!=='cancelled'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>showActiveOrdersModal(order),className:\"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center hover:bg-red-600 transition-colors cursor-pointer\",title:\"Cannot complete - customer has other active orders. Click to view details.\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"\\u26A0\\uFE0F\"})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleViewOrderDetails(order.id),className:\"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors\",children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteOrder(order.id),className:\"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors\",children:\"Delete\"})]})})]},\"\".concat(order.id,\"-\").concat(order.status,\"-\").concat(order.updated_at||order.created_at)))})]})}),orders.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-400\",children:\"No orders found\"})})]}),showOrderModal&&selectedOrderDetails&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0.9},className:\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 border border-sangeet-neutral-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-sangeet-400\",children:[\"Order #\",selectedOrderDetails.order_number]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sangeet-neutral-400\",children:[\"Table \",selectedOrderDetails.table_number,\" \\u2022 \",selectedOrderDetails.customer_name]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowOrderModal(false),className:\"text-sangeet-neutral-400 hover:text-sangeet-neutral-300 text-2xl\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-sm font-medium text-white \".concat(getStatusColor(selectedOrderDetails.status)),children:selectedOrderDetails.status.charAt(0).toUpperCase()+selectedOrderDetails.status.slice(1)})}),selectedOrderDetails.items&&selectedOrderDetails.items.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-sangeet-neutral-200 mb-4\",children:\"Order Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:sortItemsByNewness(selectedOrderDetails.items).map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 py-2 border-b border-sangeet-neutral-700/50 last:border-b-0 relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-sangeet-neutral-700 rounded-full flex items-center justify-center text-xs font-semibold\",children:item.quantity}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-200 font-medium\",children:item.name}),isNewItem(item.created_at)&&/*#__PURE__*/_jsx(\"span\",{className:\"bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium animate-pulse\",children:\"NEW\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-sangeet-neutral-400\",children:[\"$\",parseFloat(item.unit_price).toFixed(2),\" each\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-sangeet-neutral-500\",children:getTimeSinceAdded(item.created_at)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sangeet-neutral-200 font-semibold\",children:[\"$\",parseFloat(item.total_price).toFixed(2)]})})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-400 text-sm\",children:\"Order Date\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-200 font-medium\",children:formatDate(selectedOrderDetails.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-400 text-sm\",children:\"Order Time\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-200 font-medium\",children:new Date(selectedOrderDetails.created_at).toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-400 text-sm\",children:\"Customer\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-200 font-medium\",children:selectedOrderDetails.customer_name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-400 text-sm\",children:\"Table\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-200 font-medium\",children:selectedOrderDetails.table_number})]})]}),selectedOrderDetails.special_instructions&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-400 text-sm mb-2\",children:\"Special Instructions\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-200 bg-sangeet-neutral-800/50 rounded-lg p-3\",children:selectedOrderDetails.special_instructions})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-sangeet-neutral-700 pt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-sangeet-neutral-200\",children:\"Total Amount\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-sangeet-400\",children:[\"$\",parseFloat(selectedOrderDetails.total_amount).toFixed(2)]})]})})]})}),activeOrdersModal.isOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:0.9,y:20},className:\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-8 border border-sangeet-neutral-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-4\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-red-400 mb-2\",children:\"Cannot Complete Order\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sangeet-neutral-300\",children:[activeOrdersModal.customerName,\" has other active orders that must be completed first.\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-900/20 border border-red-500/30 rounded-xl p-4 mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-red-300 font-medium mb-3\",children:\"Active Orders:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:activeOrdersModal.activeOrders.map(order=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-sangeet-neutral-800/50 rounded-lg p-3 border border-sangeet-neutral-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sangeet-400 font-semibold\",children:[\"Order #\",order.order_number]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-medium text-white \".concat(getStatusColor(order.status)),children:order.status.charAt(0).toUpperCase()+order.status.slice(1)})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sangeet-neutral-400 text-sm\",children:[\"Table \",order.table_number]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sangeet-neutral-300 text-sm\",children:[\"Created: \",formatDate(order.created_at)]})]},order.id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-900/20 border border-yellow-500/30 rounded-xl p-4 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-400 text-xl\",children:\"\\uD83D\\uDCA1\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-yellow-300 font-medium mb-1\",children:\"Instructions:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-yellow-200 text-sm space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Complete all active orders for this customer first\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Then you can complete the current order\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 This prevents orphaned orders and ensures proper payment flow\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:closeActiveOrdersModal,className:\"bg-sangeet-neutral-700 hover:bg-sangeet-neutral-600 text-sangeet-neutral-200 font-medium py-3 px-8 rounded-xl transition-colors duration-200\",children:\"Got It\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:closeActiveOrdersModal,className:\"absolute top-4 right-4 text-sangeet-neutral-400 hover:text-sangeet-neutral-200 text-2xl transition-colors duration-200\",children:\"\\xD7\"})]})}),deleteModal.isOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:0.9,y:20},className:\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-8 border border-sangeet-neutral-700 max-w-md w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-4\",children:\"\\uD83D\\uDDD1\\uFE0F\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-red-400 mb-2\",children:\"Delete Order\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-300\",children:\"Are you sure you want to delete this order? This action cannot be undone.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-900/20 border border-red-500/30 rounded-xl p-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-300 font-medium\",children:[\"Order #\",deleteModal.orderNumber]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-red-400 text-sm\",children:\"\\u26A0\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sangeet-neutral-300 text-sm\",children:[deleteModal.customerName,\" \\u2022 Table \",deleteModal.tableNumber]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-900/20 border border-yellow-500/30 rounded-xl p-4 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-400 text-xl\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-yellow-300 font-medium mb-1\",children:\"Important:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-yellow-200 text-sm space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Order will be permanently deleted\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Customer will be notified automatically\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 All order data will be cleared\"})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:cancelDeleteOrder,className:\"flex-1 bg-sangeet-neutral-700 hover:bg-sangeet-neutral-600 text-sangeet-neutral-200 font-medium py-3 px-4 rounded-xl transition-colors duration-200\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:confirmDeleteOrder,className:\"flex-1 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-medium py-3 px-4 rounded-xl transition-all duration-200\",children:\"Delete Order\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelDeleteOrder,className:\"absolute top-4 right-4 text-sangeet-neutral-400 hover:text-sangeet-neutral-200 text-2xl transition-colors duration-200\",children:\"\\xD7\"})]})})]})]});};export default AdminOrdersPage;","map":{"version":3,"names":["React","useState","useEffect","motion","useNavigate","isNewItem","getTimeSinceAdded","sortItemsByNewness","hasMultipleSessions","updateOrderStatus","deleteOrder","bulkUpdateOrderStatus","searchOrders","fetchTables","getOrderById","toast","AdminHeader","socketService","CustomDropdown","jsx","_jsx","jsxs","_jsxs","AdminOrdersPage","navigate","orders","setOrders","loading","setLoading","selectedOrders","setSelectedOrders","filters","setFilters","status","table_id","date_from","date_to","query","tables","setTables","viewMode","setViewMode","completedOrders","setCompletedOrders","selectedOrderDetails","setSelectedOrderDetails","showOrderModal","setShowOrderModal","deleteModal","setDeleteModal","isOpen","orderId","orderNumber","customerName","tableNumber","activeOrdersModal","setActiveOrdersModal","activeOrders","blockedOrderId","statusOptions","value","label","loadDashboardData","searchParams","_objectSpread","ordersData","tablesData","Promise","all","filter","order","error","console","isConnected","connect","joinAdminRoom","handleNewOrder","success","handleStatusUpdate","data","handleOrderDeleted","onNewOrder","onOrderStatusUpdate","onOrderDeleted","removeListener","isValidStatusTransition","currentStatus","newStatus","_statusFlow$currentSt","statusFlow","includes","canCompleteOrder","otherActiveOrders","o","id","customer_name","length","getOtherActiveOrders","showActiveOrdersModal","closeActiveOrdersModal","currentOrder","find","concat","_error$response","_error$response$data","_error$response$data$","response","duration","activeOrdersList","map","order_number","join","handleDeleteOrder","orderToDelete","table_number","confirmDeleteOrder","setTimeout","cancelDeleteOrder","handleViewOrderDetails","orderDetails","handleBulkStatusUpdate","handleClearCompletedOrders","confirmed","window","confirm","handleOrderSelection","prev","handleSelectAll","currentOrders","selectableOrders","getStatusColor","colors","pending","preparing","ready","completed","cancelled","formatDate","dateString","Date","toLocaleString","className","children","mode","onClick","charAt","toUpperCase","slice","type","placeholder","onChange","e","target","tableId","options","table","checked","tr","initial","opacity","animate","disabled","title","items","total_amount","updated_at","created_at","div","scale","exit","item","index","quantity","name","parseFloat","unit_price","toFixed","total_price","toLocaleTimeString","hour","minute","hour12","special_instructions","y"],"sources":["/Users/amanrana/Desktop/sangeet_restaurant_fresh/frontend/src/pages/AdminOrdersPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport { useNavigate } from 'react-router-dom';\nimport { isNewItem, getTimeSinceAdded, sortItemsByNewness, hasMultipleSessions } from '../utils/itemUtils';\nimport { \n  updateOrderStatus, \n  deleteOrder, \n  bulkUpdateOrderStatus,\n  searchOrders,\n  fetchTables,\n  getOrderById\n} from '../services/api';\nimport toast from 'react-hot-toast';\nimport AdminHeader from '../components/AdminHeader';\nimport socketService from '../services/socketService';\nimport CustomDropdown from '../components/CustomDropdown';\n\nconst AdminOrdersPage = () => {\n\n  \n  // eslint-disable-next-line no-unused-vars\n  const navigate = useNavigate();\n  const [orders, setOrders] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedOrders, setSelectedOrders] = useState([]);\n  const [filters, setFilters] = useState({\n    status: '',\n    table_id: '',\n    date_from: '',\n    date_to: '',\n    query: ''\n  });\n  const [tables, setTables] = useState([]);\n  const [viewMode, setViewMode] = useState('all'); // all, pending, preparing, ready, completed\n  const [completedOrders, setCompletedOrders] = useState([]); // Track completed orders separately\n  const [selectedOrderDetails, setSelectedOrderDetails] = useState(null);\n  const [showOrderModal, setShowOrderModal] = useState(false);\n  const [deleteModal, setDeleteModal] = useState({\n    isOpen: false,\n    orderId: null,\n    orderNumber: null,\n    customerName: null,\n    tableNumber: null\n  });\n\n  const [activeOrdersModal, setActiveOrdersModal] = useState({\n    isOpen: false,\n    customerName: null,\n    activeOrders: [],\n    blockedOrderId: null\n  });\n\n  const statusOptions = [\n    { value: 'pending', label: 'Pending' },\n    { value: 'preparing', label: 'Preparing' },\n    { value: 'ready', label: 'Ready' },\n    { value: 'completed', label: 'Completed' },\n    { value: 'cancelled', label: 'Cancelled' }\n  ];\n\n  const loadDashboardData = async () => {\n    try {\n      setLoading(true);\n      // Load orders based on filters and view mode\n      let searchParams = { ...filters };\n      if (viewMode !== 'all') {\n        searchParams.status = viewMode;\n      }\n      \n      const [ordersData, tablesData] = await Promise.all([\n        searchOrders(searchParams),\n        fetchTables()\n      ]);\n      \n      // Separate completed orders from active orders\n      const activeOrders = (ordersData || []).filter(order => order.status !== 'completed');\n      const completedOrders = (ordersData || []).filter(order => order.status === 'completed');\n      \n      setOrders(activeOrders);\n      setCompletedOrders(completedOrders);\n      setTables(tablesData);\n    } catch (error) {\n      console.error('Error loading dashboard data:', error);\n      toast.error('Failed to load dashboard data');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n\n  \n  // Data loading useEffect - ALWAYS RUN\n  useEffect(() => {\n    loadDashboardData(); // eslint-disable-line react-hooks/exhaustive-deps\n  }, [filters, viewMode]); // eslint-disable-line react-hooks/exhaustive-deps\n  \n  // Socket setup for realtime updates - minimal: reload on any event\n  useEffect(() => {\n    try {\n      if (!socketService.isConnected) {\n        socketService.connect();\n      }\n      socketService.joinAdminRoom();\n\n      const handleNewOrder = () => {\n        toast.success('New order received');\n        loadDashboardData();\n      };\n\n      const handleStatusUpdate = (data) => {\n        loadDashboardData();\n      };\n\n      const handleOrderDeleted = (data) => {\n        loadDashboardData();\n      };\n\n      socketService.onNewOrder(handleNewOrder);\n      socketService.onOrderStatusUpdate(handleStatusUpdate);\n      socketService.onOrderDeleted(handleOrderDeleted);\n\n      return () => {\n        socketService.removeListener('new-order');\n        socketService.removeListener('order-status-update');\n        socketService.removeListener('order-deleted');\n      };\n    } catch (error) {\n      console.error('Error setting up socket:', error);\n    }\n  }, []);\n\n\n  // Validate status transitions to prevent backward movement\n  const isValidStatusTransition = (currentStatus, newStatus) => {\n    const statusFlow = {\n      'pending': ['preparing', 'cancelled'],\n      'preparing': ['ready', 'cancelled'],\n      'ready': ['completed', 'cancelled'],\n      'completed': [], // No further transitions allowed\n      'cancelled': [] // No further transitions allowed\n    };\n    \n    return statusFlow[currentStatus]?.includes(newStatus) || false;\n  };\n\n  // Check if order can be completed (no other active orders for same customer)\n  const canCompleteOrder = (order) => {\n    // Check if customer has other active orders\n    const otherActiveOrders = orders.filter(o => \n      o.id !== order.id && \n      o.customer_name === order.customer_name &&\n      o.status !== 'completed' && \n      o.status !== 'cancelled'\n    );\n    \n    return otherActiveOrders.length === 0;\n  };\n\n  // Get other active orders for a customer\n  const getOtherActiveOrders = (order) => {\n    return orders.filter(o => \n      o.id !== order.id && \n      o.customer_name === order.customer_name &&\n      o.status !== 'completed' && \n      o.status !== 'cancelled'\n    );\n  };\n\n  // Show active orders modal\n  const showActiveOrdersModal = (order) => {\n    const otherActiveOrders = getOtherActiveOrders(order);\n    setActiveOrdersModal({\n      isOpen: true,\n      customerName: order.customer_name,\n      activeOrders: otherActiveOrders,\n      blockedOrderId: order.id\n    });\n  };\n\n  // Close active orders modal\n  const closeActiveOrdersModal = () => {\n    setActiveOrdersModal({\n      isOpen: false,\n      customerName: null,\n      activeOrders: [],\n      blockedOrderId: null\n    });\n  };\n\n  const handleStatusUpdate = async (orderId, newStatus) => {\n    try {\n      // Find the current order to get its status\n      const currentOrder = orders.find(order => order.id === orderId) || \n                          completedOrders.find(order => order.id === orderId);\n      \n      if (!currentOrder) {\n        toast.error('Order not found');\n        return;\n      }\n\n      // Validate status transition\n      if (!isValidStatusTransition(currentOrder.status, newStatus)) {\n        toast.error(`Cannot change status from \"${currentOrder.status}\" to \"${newStatus}\". Invalid transition.`);\n        return;\n      }\n\n      await updateOrderStatus(orderId, newStatus);\n      toast.success('Order status updated successfully');\n      // Don't reload data since socket will handle the update\n    } catch (error) {\n      console.error('Error updating order status:', error);\n      \n      // Handle specific error for active orders\n      if (error.response?.data?.error?.includes('other active orders')) {\n        const activeOrders = error.response.data.activeOrders;\n        const customerName = error.response.data.customerName;\n        \n        // Show detailed error with active orders list\n        toast.error(`Cannot complete order. ${customerName} has other active orders.`, {\n          duration: 8000\n        });\n        \n        // Show active orders details\n        const activeOrdersList = activeOrders.map(order => \n          `Order #${order.order_number} (${order.status})`\n        ).join(', ');\n        \n        toast.success(`Active orders: ${activeOrdersList}`, {\n          duration: 10000\n        });\n      } else {\n        toast.error('Failed to update order status');\n      }\n    }\n  };\n\n  const handleDeleteOrder = async (orderId) => {\n    // Find the order details to show in modal\n    const orderToDelete = orders.find(order => order.id === orderId) || \n                         completedOrders.find(order => order.id === orderId);\n    \n    if (orderToDelete) {\n      setDeleteModal({\n        isOpen: true,\n        orderId: orderId,\n        orderNumber: orderToDelete.order_number || orderId,\n        customerName: orderToDelete.customer_name,\n        tableNumber: orderToDelete.table_number\n      });\n    }\n  };\n\n  const confirmDeleteOrder = async () => {\n    try {\n      await deleteOrder(deleteModal.orderId);\n      toast.success('Order deleted successfully');\n      setDeleteModal({ isOpen: false, orderId: null, orderNumber: null, customerName: null, tableNumber: null });\n      \n      // Fallback: reload data after a short delay if socket doesn't work\n      setTimeout(() => {\n        loadDashboardData();\n      }, 1000);\n    } catch (error) {\n      toast.error('Failed to delete order');\n    }\n  };\n\n  const cancelDeleteOrder = () => {\n    setDeleteModal({ isOpen: false, orderId: null, orderNumber: null, customerName: null, tableNumber: null });\n  };\n\n  const handleViewOrderDetails = async (orderId) => {\n    try {\n      const orderDetails = await getOrderById(orderId);\n      setSelectedOrderDetails(orderDetails);\n      setShowOrderModal(true);\n    } catch (error) {\n      console.error('Error fetching order details:', error);\n      toast.error('Failed to load order details');\n    }\n  };\n\n  const handleBulkStatusUpdate = async (status) => {\n    if (selectedOrders.length === 0) {\n      toast.error('Please select orders to update');\n      return;\n    }\n\n    try {\n      await bulkUpdateOrderStatus(selectedOrders, status);\n      toast.success(`${selectedOrders.length} orders updated successfully`);\n      setSelectedOrders([]);\n      // Don't reload data since socket will handle the updates\n    } catch (error) {\n      toast.error('Failed to bulk update orders');\n    }\n  };\n\n  const handleClearCompletedOrders = () => {\n    // Show confirmation dialog\n    const confirmed = window.confirm('Clear completed orders from screen? (Data will be kept for analytics)');\n    \n    if (!confirmed) {\n      return;\n    }\n\n    // Clear completed orders from local state only (keep in database)\n    setCompletedOrders([]);\n    \n    toast.success('Completed orders cleared from screen');\n  };\n\n    const handleOrderSelection = (orderId) => {\n    // Find the order to check its status\n    const order = orders.find(o => o.id === orderId) || completedOrders.find(o => o.id === orderId);\n    \n    // Prevent selection of completed or cancelled orders\n    if (order && (order.status === 'completed' || order.status === 'cancelled')) {\n      toast.error('Cannot select completed or cancelled orders for bulk actions');\n      return;\n    }\n    \n    setSelectedOrders(prev =>\n      prev.includes(orderId)\n        ? prev.filter(id => id !== orderId)\n        : [...prev, orderId]\n    );\n  };\n\n  const handleSelectAll = () => {\n    const currentOrders = viewMode === 'completed' ? completedOrders : orders;\n    // Filter out completed and cancelled orders from bulk selection\n    const selectableOrders = currentOrders.filter(order => \n      order.status !== 'completed' && order.status !== 'cancelled'\n    );\n    \n    if (selectedOrders.length === selectableOrders.length) {\n      setSelectedOrders([]);\n    } else {\n      setSelectedOrders(selectableOrders.map(order => order.id));\n    }\n  };\n\n  const getStatusColor = (status) => {\n    const colors = {\n      pending: 'bg-yellow-500',\n      confirmed: 'bg-blue-500',\n      preparing: 'bg-orange-500',\n      ready: 'bg-green-500',\n      completed: 'bg-gray-500',\n      cancelled: 'bg-red-500'\n    };\n    return colors[status] || 'bg-gray-500';\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleString();\n  };\n\n\n  \n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-sangeet-neutral-950 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"spinner mx-auto mb-4\"></div>\n          <p className=\"text-sangeet-400\">Loading admin dashboard...</p>\n        </div>\n      </div>\n    );\n  }\n\n\n  \n  return (\n    <div className=\"min-h-screen bg-sangeet-neutral-950\">\n      <AdminHeader />\n\n      <div className=\"max-w-7xl mx-auto p-6\">\n        {/* Live Updates Indicator */}\n        <div className=\"bg-blue-900/20 border border-blue-500/30 rounded-xl p-4 mb-6 text-center\">\n          <div className=\"flex items-center justify-center space-x-2\">\n            <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\"></div>\n            <p className=\"text-blue-300 text-sm\">\n              🔄 Order list updates automatically in real-time\n            </p>\n          </div>\n        </div>\n\n\n\n        {/* Filters and Controls */}\n        <div className=\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-xl p-6 mb-6 border border-sangeet-neutral-700\">\n          {/* Status Filter Buttons Row */}\n          <div className=\"flex flex-wrap gap-2 mb-4\">\n            {['all', 'pending', 'preparing', 'ready', 'completed'].map((mode) => (\n              <button\n                key={mode}\n                onClick={() => setViewMode(mode)}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                  viewMode === mode\n                    ? 'bg-sangeet-400 text-sangeet-neutral-950'\n                    : 'bg-sangeet-neutral-800 text-sangeet-neutral-400 hover:bg-sangeet-neutral-700'\n                }`}\n              >\n                {mode.charAt(0).toUpperCase() + mode.slice(1)}\n                {mode === 'completed' && completedOrders.length > 0 && (\n                  <span className=\"ml-1 bg-sangeet-neutral-700 text-sangeet-neutral-300 px-1.5 py-0.5 rounded-full text-xs\">\n                    {completedOrders.length}\n                  </span>\n                )}\n              </button>\n            ))}\n                          {viewMode === 'completed' && completedOrders.length > 0 && (\n                <button\n                  onClick={handleClearCompletedOrders}\n                  className=\"px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition-colors\"\n                >\n                  Clear\n                </button>\n              )}\n          </div>\n\n          {/* Search and Table Filter Row */}\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            {/* Search */}\n            <div className=\"md:col-span-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Search by customer name or order number...\"\n                value={filters.query}\n                onChange={(e) => setFilters(prev => ({ ...prev, query: e.target.value }))}\n                className=\"w-full px-4 py-2 bg-sangeet-neutral-800 border border-sangeet-neutral-700 rounded-lg text-sangeet-neutral-300 focus:outline-none focus:border-sangeet-400\"\n              />\n            </div>\n\n            {/* Table Filter */}\n            <div>\n              <CustomDropdown\n                value={filters.table_id}\n                onChange={(tableId) => setFilters(prev => ({ ...prev, table_id: tableId }))}\n                options={[\n                  { value: '', label: 'All Tables' },\n                  ...tables.map(table => ({ \n                    value: table.id, \n                    label: `Table ${table.table_number}` \n                  }))\n                ]}\n                className=\"w-full\"\n              />\n            </div>\n          </div>\n\n          {/* Date Filters */}\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4\">\n            <div>\n              <label className=\"block text-sangeet-neutral-400 text-sm mb-2\">From Date</label>\n              <input\n                type=\"date\"\n                value={filters.date_from}\n                onChange={(e) => setFilters(prev => ({ ...prev, date_from: e.target.value }))}\n                className=\"w-full px-4 py-2 bg-sangeet-neutral-800 border border-sangeet-neutral-700 rounded-lg text-sangeet-neutral-300 focus:outline-none focus:border-sangeet-400 [&::-webkit-calendar-picker-indicator]:filter [&::-webkit-calendar-picker-indicator]:invert [&::-webkit-calendar-picker-indicator]:brightness-0 [&::-webkit-calendar-picker-indicator]:contrast-200\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sangeet-neutral-400 text-sm mb-2\">To Date</label>\n              <input\n                type=\"date\"\n                value={filters.date_to}\n                onChange={(e) => setFilters(prev => ({ ...prev, date_to: e.target.value }))}\n                className=\"w-full px-4 py-2 bg-sangeet-neutral-800 border border-sangeet-neutral-700 rounded-lg text-sangeet-neutral-300 focus:outline-none focus:border-sangeet-400 [&::-webkit-calendar-picker-indicator]:filter [&::-webkit-calendar-picker-indicator]:invert [&::-webkit-calendar-picker-indicator]:brightness-0 [&::-webkit-calendar-picker-indicator]:contrast-200\"\n              />\n            </div>\n            <div className=\"flex items-end\">\n              <button\n                onClick={() => setFilters({ status: '', table_id: '', date_from: '', date_to: '', query: '' })}\n                className=\"w-full px-4 py-2 bg-sangeet-neutral-700 text-sangeet-neutral-300 rounded-lg hover:bg-sangeet-neutral-600 transition-colors\"\n              >\n                Clear Filters\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* Bulk Actions */}\n        {selectedOrders.length > 0 && (\n          <div className=\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-xl p-4 mb-6 border border-sangeet-neutral-700\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sangeet-neutral-400\">\n                  {selectedOrders.length} order(s) selected\n                </p>\n                <p className=\"text-xs text-sangeet-neutral-500 mt-1\">\n                  💡 Completed and cancelled orders cannot be modified\n                </p>\n              </div>\n              <div className=\"flex space-x-2\">\n                {['preparing', 'ready', 'completed', 'cancelled'].map((status) => (\n                  <button\n                    key={status}\n                    onClick={() => handleBulkStatusUpdate(status)}\n                    className=\"px-3 py-1 bg-sangeet-400 text-sangeet-neutral-950 rounded text-sm font-medium hover:bg-sangeet-300 transition-colors\"\n                  >\n                    Mark {status.charAt(0).toUpperCase() + status.slice(1)}\n                  </button>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Orders Table */}\n        <div className=\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-xl border border-sangeet-neutral-700 overflow-hidden\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead className=\"bg-sangeet-neutral-800\">\n                <tr>\n                  <th className=\"px-6 py-4 text-left\">\n                    <input\n                      type=\"checkbox\"\n                      checked={(() => {\n                        const currentOrders = viewMode === 'completed' ? completedOrders : orders;\n                        const selectableOrders = currentOrders.filter(order => \n                          order.status !== 'completed' && order.status !== 'cancelled'\n                        );\n                        return selectedOrders.length === selectableOrders.length && selectableOrders.length > 0;\n                      })()}\n                      onChange={handleSelectAll}\n                      className=\"rounded border-sangeet-neutral-600 bg-sangeet-neutral-800 text-sangeet-400 focus:ring-sangeet-400\"\n                    />\n                  </th>\n                  <th className=\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\">Order #</th>\n                  <th className=\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\">Customer</th>\n                  <th className=\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\">Table</th>\n                  <th className=\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\">Amount</th>\n                  <th className=\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\">Status</th>\n                  <th className=\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\">Date</th>\n                  <th className=\"px-6 py-4 text-left text-sangeet-neutral-400 font-medium\">Actions</th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-sangeet-neutral-700\">\n                {(viewMode === 'completed' ? completedOrders : orders).map((order) => (\n                  <motion.tr\n                    key={`${order.id}-${order.status}-${order.updated_at || order.created_at}`}\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    className=\"hover:bg-sangeet-neutral-800 transition-colors\"\n                  >\n                    <td className=\"px-6 py-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedOrders.includes(order.id)}\n                        onChange={() => handleOrderSelection(order.id)}\n                        disabled={order.status === 'completed' || order.status === 'cancelled'}\n                        className={`rounded border-sangeet-neutral-600 focus:ring-sangeet-400 ${\n                          order.status === 'completed' || order.status === 'cancelled'\n                            ? 'bg-sangeet-neutral-700 text-sangeet-neutral-500 cursor-not-allowed'\n                            : 'bg-sangeet-neutral-800 text-sangeet-400'\n                        }`}\n                        title={order.status === 'completed' || order.status === 'cancelled' \n                          ? `Cannot select ${order.status} orders for bulk actions` \n                          : 'Select for bulk actions'\n                        }\n                      />\n                    </td>\n                    <td className=\"px-6 py-4 text-sangeet-400 font-medium\">\n                      <div className=\"flex items-center space-x-2\">\n                        <span>{order.order_number}</span>\n                        {order.items && hasMultipleSessions(order.items) && (\n                          <span className=\"bg-blue-500 text-white px-1 py-0.5 rounded text-xs font-medium\" title=\"Merged Order\">\n                            🔄\n                          </span>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 text-sangeet-neutral-300\">{order.customer_name}</td>\n                    <td className=\"px-6 py-4 text-sangeet-neutral-300\">Table {order.table_number}</td>\n                    <td className=\"px-6 py-4 text-sangeet-400 font-medium\">${order.total_amount}</td>\n                    <td className=\"px-6 py-4\">\n                      <div className=\"relative\">\n                        <span className={`px-2 py-1 rounded-full text-xs font-medium text-white ${getStatusColor(order.status)} transition-all duration-300`}>\n                          {order.status.charAt(0).toUpperCase() + order.status.slice(1)}\n                        </span>\n                        {order.updated_at && order.updated_at !== order.created_at && (\n                          <div className=\"text-xs text-sangeet-neutral-500 mt-1\">\n                            Updated: {formatDate(order.updated_at)}\n                          </div>\n                        )}\n                        {/* Update indicator */}\n                        {order.updated_at && order.updated_at !== order.created_at && (\n                          <div className=\"absolute -top-1 -right-1 w-2 h-2 bg-green-400 rounded-full animate-ping\"></div>\n                        )}\n                        {/* Lock indicator for completed/cancelled orders */}\n                        {(order.status === 'completed' || order.status === 'cancelled') && (\n                          <div className=\"absolute -top-1 -left-1 w-3 h-3 bg-sangeet-neutral-600 rounded-full flex items-center justify-center\">\n                            <span className=\"text-xs\">🔒</span>\n                          </div>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 text-sangeet-neutral-400 text-sm\">\n                      {formatDate(order.created_at)}\n                    </td>\n                    <td className=\"px-6 py-4\">\n                      <div className=\"flex space-x-2\">\n                        <div className=\"relative\">\n                          <CustomDropdown\n                            value={order.status}\n                            onChange={(newStatus) => handleStatusUpdate(order.id, newStatus)}\n                            options={statusOptions}\n                            className={`text-xs ${order.status === 'completed' || order.status === 'cancelled' ? 'opacity-50 cursor-not-allowed' : ''}`}\n                            disabled={order.status === 'completed' || order.status === 'cancelled'}\n                          />\n                          {(order.status === 'completed' || order.status === 'cancelled') && (\n                            <div className=\"absolute -top-1 -right-1 w-4 h-4 bg-sangeet-neutral-600 rounded-full flex items-center justify-center\">\n                              <span className=\"text-xs\">🔒</span>\n                            </div>\n                          )}\n                          {!canCompleteOrder(order) && order.status !== 'completed' && order.status !== 'cancelled' && (\n                            <button\n                              onClick={() => showActiveOrdersModal(order)}\n                              className=\"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center hover:bg-red-600 transition-colors cursor-pointer\"\n                              title=\"Cannot complete - customer has other active orders. Click to view details.\"\n                            >\n                              <span className=\"text-xs\">⚠️</span>\n                            </button>\n                          )}\n                        </div>\n                        <button\n                          onClick={() => handleViewOrderDetails(order.id)}\n                          className=\"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors\"\n                        >\n                          View\n                        </button>\n                        <button\n                          onClick={() => handleDeleteOrder(order.id)}\n                          className=\"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors\"\n                        >\n                          Delete\n                        </button>\n                      </div>\n                    </td>\n                  </motion.tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n\n          {orders.length === 0 && (\n            <div className=\"text-center py-12\">\n              <p className=\"text-sangeet-neutral-400\">No orders found</p>\n            </div>\n          )}\n        </div>\n\n        {/* Order Details Modal */}\n        {showOrderModal && selectedOrderDetails && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.9 }}\n              className=\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 border border-sangeet-neutral-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto\"\n            >\n              {/* Modal Header */}\n              <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                  <h2 className=\"text-2xl font-bold text-sangeet-400\">\n                    Order #{selectedOrderDetails.order_number}\n                  </h2>\n                  <p className=\"text-sangeet-neutral-400\">\n                    Table {selectedOrderDetails.table_number} • {selectedOrderDetails.customer_name}\n                  </p>\n                </div>\n                <button\n                  onClick={() => setShowOrderModal(false)}\n                  className=\"text-sangeet-neutral-400 hover:text-sangeet-neutral-300 text-2xl\"\n                >\n                  ×\n                </button>\n              </div>\n\n              {/* Order Status */}\n              <div className=\"mb-6\">\n                <span className={`px-3 py-1 rounded-full text-sm font-medium text-white ${getStatusColor(selectedOrderDetails.status)}`}>\n                  {selectedOrderDetails.status.charAt(0).toUpperCase() + selectedOrderDetails.status.slice(1)}\n                </span>\n              </div>\n\n              {/* Order Items */}\n              {selectedOrderDetails.items && selectedOrderDetails.items.length > 0 && (\n                <div className=\"mb-6\">\n                  <h3 className=\"text-lg font-semibold text-sangeet-neutral-200 mb-4\">Order Items</h3>\n                  <div className=\"space-y-3\">\n                    {sortItemsByNewness(selectedOrderDetails.items).map((item, index) => (\n                      <div key={index} className=\"flex items-center space-x-3 py-2 border-b border-sangeet-neutral-700/50 last:border-b-0 relative\">\n                        <div className=\"w-8 h-8 bg-sangeet-neutral-700 rounded-full flex items-center justify-center text-xs font-semibold\">\n                          {item.quantity}\n                        </div>\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center space-x-2\">\n                            <p className=\"text-sangeet-neutral-200 font-medium\">{item.name}</p>\n                            {isNewItem(item.created_at) && (\n                              <span className=\"bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium animate-pulse\">\n                                NEW\n                              </span>\n                            )}\n                          </div>\n                          <p className=\"text-sm text-sangeet-neutral-400\">\n                            ${parseFloat(item.unit_price).toFixed(2)} each\n                          </p>\n                          <p className=\"text-xs text-sangeet-neutral-500\">\n                            {getTimeSinceAdded(item.created_at)}\n                          </p>\n                        </div>\n                        <div className=\"text-right\">\n                          <p className=\"text-sangeet-neutral-200 font-semibold\">\n                            ${parseFloat(item.total_price).toFixed(2)}\n                          </p>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Order Details */}\n              <div className=\"grid grid-cols-2 gap-4 mb-6\">\n                <div>\n                  <p className=\"text-sangeet-neutral-400 text-sm\">Order Date</p>\n                  <p className=\"text-sangeet-neutral-200 font-medium\">\n                    {formatDate(selectedOrderDetails.created_at)}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sangeet-neutral-400 text-sm\">Order Time</p>\n                  <p className=\"text-sangeet-neutral-200 font-medium\">\n                    {new Date(selectedOrderDetails.created_at).toLocaleTimeString('en-US', {\n                      hour: 'numeric',\n                      minute: '2-digit',\n                      hour12: true\n                    })}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sangeet-neutral-400 text-sm\">Customer</p>\n                  <p className=\"text-sangeet-neutral-200 font-medium\">\n                    {selectedOrderDetails.customer_name}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sangeet-neutral-400 text-sm\">Table</p>\n                  <p className=\"text-sangeet-neutral-200 font-medium\">\n                    {selectedOrderDetails.table_number}\n                  </p>\n                </div>\n              </div>\n\n              {/* Special Instructions */}\n              {selectedOrderDetails.special_instructions && (\n                <div className=\"mb-6\">\n                  <p className=\"text-sangeet-neutral-400 text-sm mb-2\">Special Instructions</p>\n                  <p className=\"text-sangeet-neutral-200 bg-sangeet-neutral-800/50 rounded-lg p-3\">\n                    {selectedOrderDetails.special_instructions}\n                  </p>\n                </div>\n              )}\n\n              {/* Total */}\n              <div className=\"border-t border-sangeet-neutral-700 pt-4\">\n                <div className=\"flex justify-between items-center\">\n                  <p className=\"text-lg font-semibold text-sangeet-neutral-200\">Total Amount</p>\n                  <p className=\"text-2xl font-bold text-sangeet-400\">\n                    ${parseFloat(selectedOrderDetails.total_amount).toFixed(2)}\n                  </p>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        )}\n\n        {/* Active Orders Modal */}\n        {activeOrdersModal.isOpen && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9, y: 20 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.9, y: 20 }}\n              className=\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-8 border border-sangeet-neutral-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto\"\n            >\n              {/* Header */}\n              <div className=\"text-center mb-6\">\n                <div className=\"text-4xl mb-4\">⚠️</div>\n                <h2 className=\"text-2xl font-bold text-red-400 mb-2\">\n                  Cannot Complete Order\n                </h2>\n                <p className=\"text-sangeet-neutral-300\">\n                  {activeOrdersModal.customerName} has other active orders that must be completed first.\n                </p>\n              </div>\n\n              {/* Active Orders List */}\n              <div className=\"bg-red-900/20 border border-red-500/30 rounded-xl p-4 mb-6\">\n                <h3 className=\"text-red-300 font-medium mb-3\">Active Orders:</h3>\n                <div className=\"space-y-3\">\n                  {activeOrdersModal.activeOrders.map((order) => (\n                    <div key={order.id} className=\"bg-sangeet-neutral-800/50 rounded-lg p-3 border border-sangeet-neutral-700\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <div className=\"flex items-center space-x-2\">\n                          <span className=\"text-sangeet-400 font-semibold\">\n                            Order #{order.order_number}\n                          </span>\n                          <span className={`px-2 py-1 rounded-full text-xs font-medium text-white ${getStatusColor(order.status)}`}>\n                            {order.status.charAt(0).toUpperCase() + order.status.slice(1)}\n                          </span>\n                        </div>\n                        <span className=\"text-sangeet-neutral-400 text-sm\">\n                          Table {order.table_number}\n                        </span>\n                      </div>\n                      <div className=\"text-sangeet-neutral-300 text-sm\">\n                        Created: {formatDate(order.created_at)}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Instructions */}\n              <div className=\"bg-yellow-900/20 border border-yellow-500/30 rounded-xl p-4 mb-6\">\n                <div className=\"flex items-start space-x-3\">\n                  <span className=\"text-yellow-400 text-xl\">💡</span>\n                  <div>\n                    <p className=\"text-yellow-300 font-medium mb-1\">Instructions:</p>\n                    <ul className=\"text-yellow-200 text-sm space-y-1\">\n                      <li>• Complete all active orders for this customer first</li>\n                      <li>• Then you can complete the current order</li>\n                      <li>• This prevents orphaned orders and ensures proper payment flow</li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n\n              {/* Action Button */}\n              <div className=\"flex justify-center\">\n                <button\n                  onClick={closeActiveOrdersModal}\n                  className=\"bg-sangeet-neutral-700 hover:bg-sangeet-neutral-600 text-sangeet-neutral-200 font-medium py-3 px-8 rounded-xl transition-colors duration-200\"\n                >\n                  Got It\n                </button>\n              </div>\n\n              {/* Close Button */}\n              <button\n                onClick={closeActiveOrdersModal}\n                className=\"absolute top-4 right-4 text-sangeet-neutral-400 hover:text-sangeet-neutral-200 text-2xl transition-colors duration-200\"\n              >\n                ×\n              </button>\n            </motion.div>\n          </div>\n        )}\n\n        {/* Delete Confirmation Modal */}\n        {deleteModal.isOpen && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9, y: 20 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.9, y: 20 }}\n              className=\"bg-gradient-to-br from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-8 border border-sangeet-neutral-700 max-w-md w-full\"\n            >\n              {/* Header */}\n              <div className=\"text-center mb-6\">\n                <div className=\"text-4xl mb-4\">🗑️</div>\n                <h2 className=\"text-2xl font-bold text-red-400 mb-2\">\n                  Delete Order\n                </h2>\n                <p className=\"text-sangeet-neutral-300\">\n                  Are you sure you want to delete this order? This action cannot be undone.\n                </p>\n              </div>\n\n              {/* Order Info */}\n              <div className=\"bg-red-900/20 border border-red-500/30 rounded-xl p-4 mb-6\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <p className=\"text-red-300 font-medium\">\n                    Order #{deleteModal.orderNumber}\n                  </p>\n                  <span className=\"text-red-400 text-sm\">⚠️</span>\n                </div>\n                <p className=\"text-sangeet-neutral-300 text-sm\">\n                  {deleteModal.customerName} • Table {deleteModal.tableNumber}\n                </p>\n              </div>\n\n              {/* Warning */}\n              <div className=\"bg-yellow-900/20 border border-yellow-500/30 rounded-xl p-4 mb-6\">\n                <div className=\"flex items-start space-x-3\">\n                  <span className=\"text-yellow-400 text-xl\">⚠️</span>\n                  <div>\n                    <p className=\"text-yellow-300 font-medium mb-1\">Important:</p>\n                    <ul className=\"text-yellow-200 text-sm space-y-1\">\n                      <li>• Order will be permanently deleted</li>\n                      <li>• Customer will be notified automatically</li>\n                      <li>• All order data will be cleared</li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex space-x-3\">\n                <button\n                  onClick={cancelDeleteOrder}\n                  className=\"flex-1 bg-sangeet-neutral-700 hover:bg-sangeet-neutral-600 text-sangeet-neutral-200 font-medium py-3 px-4 rounded-xl transition-colors duration-200\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={confirmDeleteOrder}\n                  className=\"flex-1 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-medium py-3 px-4 rounded-xl transition-all duration-200\"\n                >\n                  Delete Order\n                </button>\n              </div>\n\n              {/* Close Button */}\n              <button\n                onClick={cancelDeleteOrder}\n                className=\"absolute top-4 right-4 text-sangeet-neutral-400 hover:text-sangeet-neutral-200 text-2xl transition-colors duration-200\"\n              >\n                ×\n              </button>\n            </motion.div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AdminOrdersPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}