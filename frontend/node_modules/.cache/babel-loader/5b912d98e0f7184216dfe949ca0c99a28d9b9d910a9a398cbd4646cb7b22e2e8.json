{"ast":null,"code":"import _objectSpread from\"/Users/amanrana/Desktop/sangeet_restaurant_fresh/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import{motion}from'framer-motion';import{getOrderById}from'../services/api';import socketService from'../services/socketService';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderTrackingPage=()=>{var _order$items;const navigate=useNavigate();const location=useLocation();const searchParams=new URLSearchParams(location.search);const orderId=searchParams.get('orderId');const[order,setOrder]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// Order status configuration\nconst orderStatuses={'pending':{label:'Order Received',description:'Your order has been received and is being processed',icon:'üìã',color:'text-blue-400',bgColor:'bg-blue-400/10',borderColor:'border-blue-400/30'},'preparing':{label:'Preparing',description:'Our kitchen is preparing your delicious meal',icon:'üë®‚Äçüç≥',color:'text-yellow-400',bgColor:'bg-yellow-400/10',borderColor:'border-yellow-400/30'},'ready':{label:'Ready for Pickup',description:'Your order is ready! Please collect from the counter',icon:'‚úÖ',color:'text-green-400',bgColor:'bg-green-400/10',borderColor:'border-green-400/30'},'completed':{label:'Completed',description:'Thank you for dining with us!',icon:'üéâ',color:'text-purple-400',bgColor:'bg-purple-400/10',borderColor:'border-purple-400/30'},'cancelled':{label:'Order Cancelled',description:'Your order has been cancelled by the restaurant',icon:'‚ùå',color:'text-red-400',bgColor:'bg-red-400/10',borderColor:'border-red-400/30'}};useEffect(()=>{const fetchOrder=async()=>{if(!orderId){setError('No order ID provided');setLoading(false);return;}try{setLoading(true);const orderData=await getOrderById(orderId);setOrder(orderData);}catch(err){setError('Order not found or unable to load order details');console.error('Error fetching order:',err);}finally{setLoading(false);}};fetchOrder();},[orderId]);// Socket connection for real-time order updates\nuseEffect(()=>{// Connect to socket service\nsocketService.connect();// Join customer room for order tracking\nif(orderId){socketService.joinCustomer(orderId);}// Listen for order status updates\nconst handleStatusUpdate=data=>{// Check if this update affects our order\nif(data.orderId&&orderId&&data.orderId.toString()===orderId.toString()){// Update the order status in real-time\nsetOrder(prevOrder=>{if(prevOrder){return _objectSpread(_objectSpread({},prevOrder),{},{status:data.status,updated_at:data.timestamp||new Date().toISOString()});}return prevOrder;});// Show toast notification for status changes\nconst statusMessages={'preparing':'Your order is now being prepared! üë®‚Äçüç≥','ready':'Your order is ready for pickup! ‚úÖ','completed':'Thank you for dining with us! üéâ','cancelled':'Your order has been cancelled. Redirecting to menu for fresh start...'};if(statusMessages[data.status]){if(data.status==='cancelled'){toast.error(statusMessages[data.status],{duration:5000,icon:'‚ùå'});// The 5-minute timeout will handle the fresh start automatically\n// Customer can see cancelled status and choose to wait or reset manually\n}else{toast.success(statusMessages[data.status]);}}}};// Listen for order deletion events\nconst handleOrderDeleted=data=>{// Check if this deletion affects our order\nif(data.orderId&&orderId&&data.orderId.toString()===orderId.toString()){// Clear order state\nsetOrder(null);setError('This order has been cancelled by the restaurant.');toast.error('This order has been cancelled by the restaurant.');}};socketService.onOrderStatusUpdate(handleStatusUpdate);socketService.onOrderDeleted(handleOrderDeleted);// Cleanup function\nreturn()=>{socketService.removeListener('order-status-update');socketService.removeListener('order-deleted');};},[orderId]);const getStatusStep=status=>{const statusOrder=['pending','preparing','ready','completed'];if(status==='cancelled'){return 0;// Special case for cancelled orders\n}return statusOrder.indexOf(status)+1;};const getTotalAmount=()=>{if(!(order!==null&&order!==void 0&&order.items))return 0;return order.items.reduce((total,item)=>total+parseFloat(item.total_price),0);};const formatTime=dateString=>{return new Date(dateString).toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true});};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-sangeet-neutral-950 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-sangeet-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-300\",children:\"Loading your order details...\"})]})});}if(error||!order){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-sangeet-neutral-950 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center max-w-md mx-auto px-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-sangeet-400 mb-4\",children:\"Order Not Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-300 mb-6\",children:error||'Unable to find the order you\\'re looking for. Please check your order ID and try again.'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"bg-sangeet-400 text-sangeet-neutral-950 px-6 py-3 rounded-lg font-semibold hover:bg-sangeet-300 transition-colors\",children:\"Back to Home\"})]})});}const currentStatus=orderStatuses[order.status]||orderStatuses.pending;const statusStep=getStatusStep(order.status);return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-sangeet-neutral-950 py-8 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl md:text-4xl font-bold text-sangeet-400 mb-4\",children:\"Track Your Order\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sangeet-neutral-300 text-lg\",children:[\"Order #\",order.order_number||order.id]})]}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.1},className:\"bg-gradient-to-r from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 md:p-8 shadow-2xl border border-sangeet-neutral-700 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-flex items-center justify-center w-20 h-20 rounded-full \".concat(currentStatus.bgColor,\" \").concat(currentStatus.borderColor,\" border-2 mb-4\"),children:/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl\",children:currentStatus.icon})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold \".concat(currentStatus.color,\" mb-2\"),children:currentStatus.label}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-300\",children:currentStatus.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-sangeet-neutral-200\",children:\"Order Progress\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-sangeet-neutral-400\",children:order.status==='cancelled'?'Order Cancelled':\"Step \".concat(statusStep,\" of 4\")})]}),order.status==='cancelled'?/*#__PURE__*//* Cancelled Order Display */_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-full bg-red-500/20 border-2 border-red-500/30 flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl\",children:\"\\u274C\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-red-400 mb-2\",children:\"Order Cancelled\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-300 mb-4\",children:\"Your order has been cancelled by the restaurant\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-500/10 border border-red-500/30 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-red-300 text-sm mb-3\",children:\"\\uD83D\\uDCAC Please contact restaurant staff for refund assistance\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center space-x-2 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-red-400 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-300 text-xs\",children:\"Auto fresh start in 5 minutes or click Start Fresh\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Clear any stored cart data\nlocalStorage.removeItem('cart');localStorage.removeItem('customerSession');localStorage.removeItem('sessionTimestamp');// Redirect to QR menu page for fresh start\nnavigate('/');// Show fresh start message\ntoast.success('Fresh start! Scan QR code to begin new order üçΩÔ∏è',{duration:4000,icon:'üîÑ'});},className:\"w-full bg-sangeet-400 text-sangeet-neutral-950 px-4 py-2 rounded-lg font-semibold hover:bg-sangeet-300 transition-colors text-sm\",children:\"\\uD83D\\uDD04 Start Fresh\"})]})]}):/*#__PURE__*//* Normal Progress Bar */_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-4 left-0 right-0 h-1 bg-sangeet-neutral-700 rounded-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-1 bg-gradient-to-r from-sangeet-400 to-sangeet-500 rounded-full transition-all duration-1000\",style:{width:\"\".concat(statusStep/4*100,\"%\")}})}),/*#__PURE__*/_jsx(\"div\",{className:\"relative flex justify-between\",children:Object.entries(orderStatuses).filter(_ref=>{let[status]=_ref;return status!=='cancelled';}).map((_ref2,index)=>{let[status,config]=_ref2;const isCompleted=getStatusStep(status)<=statusStep;const isCurrent=status===order.status;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 \".concat(isCompleted?'bg-sangeet-400 text-sangeet-neutral-950':'bg-sangeet-neutral-700 text-sangeet-neutral-400'),children:isCompleted?'‚úì':index+1}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium \".concat(isCurrent?currentStatus.color:'text-sangeet-neutral-400'),children:config.label})})]},status);})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-sangeet-neutral-800/50 rounded-xl p-4 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-300 mb-1\",children:\"Estimated Completion\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-sangeet-400\",children:order.status==='completed'?'Order Completed':'15-20 minutes'})]})]}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.2},className:\"grid grid-cols-1 lg:grid-cols-2 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 shadow-2xl border border-sangeet-neutral-700\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-sangeet-400 mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-2\",children:\"\\uD83D\\uDCCB\"}),\"Order Information\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-400\",children:\"Order Number:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sangeet-neutral-200 font-semibold\",children:[\"#\",order.order_number||order.id]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-400\",children:\"Customer:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-200 font-semibold\",children:order.customer_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-400\",children:\"Table:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-200 font-semibold\",children:order.table_number||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-400\",children:\"Order Time:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-200 font-semibold\",children:formatTime(order.created_at)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-400\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sangeet-neutral-200 font-semibold\",children:formatDate(order.created_at)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 shadow-2xl border border-sangeet-neutral-700\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-sangeet-400 mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-2\",children:\"\\uD83C\\uDF7D\\uFE0F\"}),\"Order Items\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[(_order$items=order.items)===null||_order$items===void 0?void 0:_order$items.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center py-2 border-b border-sangeet-neutral-700 last:border-b-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-200 font-medium\",children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-sangeet-neutral-400\",children:[\"Qty: \",item.quantity,\" \\xD7 $\",parseFloat(item.unit_price).toFixed(2)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sangeet-neutral-200 font-semibold\",children:[\"$\",parseFloat(item.total_price).toFixed(2)]})})]},index)),/*#__PURE__*/_jsx(\"div\",{className:\"pt-3 border-t border-sangeet-neutral-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-semibold text-sangeet-neutral-200\",children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-bold text-sangeet-400\",children:[\"$\",getTotalAmount().toFixed(2)]})]})})]})]})]}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.3},className:\"flex flex-col sm:flex-row gap-4 justify-center mt-8\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"bg-sangeet-neutral-700 hover:bg-sangeet-neutral-600 text-sangeet-neutral-200 px-6 py-3 rounded-xl font-semibold transition-colors\",children:\"Back to Home\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/menu'),className:\"bg-sangeet-400 hover:bg-sangeet-300 text-sangeet-neutral-950 px-6 py-3 rounded-xl font-semibold transition-colors\",children:\"Order More Food\"})]}),(order.status==='ready'||order.status==='completed')&&/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.4},className:\"mt-8 bg-gradient-to-r from-yellow-900/20 to-orange-900/20 rounded-2xl p-6 border border-yellow-500/30\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl mb-3\",children:\"\\u2B50\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-yellow-400 mb-2\",children:\"How was your dining experience?\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sangeet-neutral-300 mb-4\",children:\"We'd love to hear about your meal! Your feedback helps us improve and serve you better.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href=\"/review?orderId=\".concat(orderId,\"&table=\").concat(order.table_number,\"&customerName=\").concat(encodeURIComponent(order.customer_name)),className:\"bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-300 hover:to-orange-400 text-sangeet-neutral-950 py-3 px-6 rounded-lg font-semibold transition-all duration-300 shadow-lg hover:shadow-xl\",children:\"Share Your Experience\"})]})}),/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:0.4},className:\"text-center mt-6\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-sangeet-neutral-400\",children:\"\\uD83D\\uDD04 This page automatically updates every 30 seconds\"})})]})});};export default OrderTrackingPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useLocation","motion","getOrderById","socketService","toast","jsx","_jsx","jsxs","_jsxs","OrderTrackingPage","_order$items","navigate","location","searchParams","URLSearchParams","search","orderId","get","order","setOrder","loading","setLoading","error","setError","orderStatuses","label","description","icon","color","bgColor","borderColor","fetchOrder","orderData","err","console","connect","joinCustomer","handleStatusUpdate","data","toString","prevOrder","_objectSpread","status","updated_at","timestamp","Date","toISOString","statusMessages","duration","success","handleOrderDeleted","onOrderStatusUpdate","onOrderDeleted","removeListener","getStatusStep","statusOrder","indexOf","getTotalAmount","items","reduce","total","item","parseFloat","total_price","formatTime","dateString","toLocaleTimeString","hour","minute","hour12","formatDate","toLocaleDateString","weekday","year","month","day","className","children","onClick","currentStatus","pending","statusStep","div","initial","opacity","y","animate","order_number","id","transition","delay","concat","localStorage","removeItem","style","width","Object","entries","filter","_ref","map","_ref2","index","config","isCompleted","isCurrent","customer_name","table_number","created_at","name","quantity","unit_price","toFixed","window","href","encodeURIComponent"],"sources":["/Users/amanrana/Desktop/sangeet_restaurant_fresh/frontend/src/pages/OrderTrackingPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { getOrderById } from '../services/api';\nimport socketService from '../services/socketService';\nimport toast from 'react-hot-toast';\n\nconst OrderTrackingPage = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const searchParams = new URLSearchParams(location.search);\n  const orderId = searchParams.get('orderId');\n  \n  const [order, setOrder] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Order status configuration\n  const orderStatuses = {\n    'pending': {\n      label: 'Order Received',\n      description: 'Your order has been received and is being processed',\n      icon: 'üìã',\n      color: 'text-blue-400',\n      bgColor: 'bg-blue-400/10',\n      borderColor: 'border-blue-400/30'\n    },\n    'preparing': {\n      label: 'Preparing',\n      description: 'Our kitchen is preparing your delicious meal',\n      icon: 'üë®‚Äçüç≥',\n      color: 'text-yellow-400',\n      bgColor: 'bg-yellow-400/10',\n      borderColor: 'border-yellow-400/30'\n    },\n    'ready': {\n      label: 'Ready for Pickup',\n      description: 'Your order is ready! Please collect from the counter',\n      icon: '‚úÖ',\n      color: 'text-green-400',\n      bgColor: 'bg-green-400/10',\n      borderColor: 'border-green-400/30'\n    },\n    'completed': {\n      label: 'Completed',\n      description: 'Thank you for dining with us!',\n      icon: 'üéâ',\n      color: 'text-purple-400',\n      bgColor: 'bg-purple-400/10',\n      borderColor: 'border-purple-400/30'\n    },\n    'cancelled': {\n      label: 'Order Cancelled',\n      description: 'Your order has been cancelled by the restaurant',\n      icon: '‚ùå',\n      color: 'text-red-400',\n      bgColor: 'bg-red-400/10',\n      borderColor: 'border-red-400/30'\n    }\n  };\n\n  useEffect(() => {\n    const fetchOrder = async () => {\n      if (!orderId) {\n        setError('No order ID provided');\n        setLoading(false);\n        return;\n      }\n\n      try {\n        setLoading(true);\n        const orderData = await getOrderById(orderId);\n        setOrder(orderData);\n      } catch (err) {\n        setError('Order not found or unable to load order details');\n        console.error('Error fetching order:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchOrder();\n  }, [orderId]);\n\n  // Socket connection for real-time order updates\n  useEffect(() => {\n    // Connect to socket service\n    socketService.connect();\n    \n    // Join customer room for order tracking\n    if (orderId) {\n      socketService.joinCustomer(orderId);\n    }\n\n    // Listen for order status updates\n    const handleStatusUpdate = (data) => {\n      // Check if this update affects our order\n      if (data.orderId && orderId && \n          data.orderId.toString() === orderId.toString()) {\n        \n        // Update the order status in real-time\n        setOrder(prevOrder => {\n          if (prevOrder) {\n            return {\n              ...prevOrder,\n              status: data.status,\n              updated_at: data.timestamp || new Date().toISOString()\n            };\n          }\n          return prevOrder;\n        });\n        \n        // Show toast notification for status changes\n        const statusMessages = {\n          'preparing': 'Your order is now being prepared! üë®‚Äçüç≥',\n          'ready': 'Your order is ready for pickup! ‚úÖ',\n          'completed': 'Thank you for dining with us! üéâ',\n          'cancelled': 'Your order has been cancelled. Redirecting to menu for fresh start...'\n        };\n        \n        if (statusMessages[data.status]) {\n          if (data.status === 'cancelled') {\n            toast.error(statusMessages[data.status], {\n              duration: 5000,\n              icon: '‚ùå'\n            });\n            \n            // The 5-minute timeout will handle the fresh start automatically\n            // Customer can see cancelled status and choose to wait or reset manually\n          } else {\n            toast.success(statusMessages[data.status]);\n          }\n        }\n      }\n    };\n\n    // Listen for order deletion events\n    const handleOrderDeleted = (data) => {\n      // Check if this deletion affects our order\n      if (data.orderId && orderId && \n          data.orderId.toString() === orderId.toString()) {\n        \n        // Clear order state\n        setOrder(null);\n        setError('This order has been cancelled by the restaurant.');\n        \n        toast.error('This order has been cancelled by the restaurant.');\n      }\n    };\n\n    socketService.onOrderStatusUpdate(handleStatusUpdate);\n    socketService.onOrderDeleted(handleOrderDeleted);\n\n    // Cleanup function\n    return () => {\n      socketService.removeListener('order-status-update');\n      socketService.removeListener('order-deleted');\n    };\n  }, [orderId]);\n\n  const getStatusStep = (status) => {\n    const statusOrder = ['pending', 'preparing', 'ready', 'completed'];\n    if (status === 'cancelled') {\n      return 0; // Special case for cancelled orders\n    }\n    return statusOrder.indexOf(status) + 1;\n  };\n\n  const getTotalAmount = () => {\n    if (!order?.items) return 0;\n    return order.items.reduce((total, item) => total + parseFloat(item.total_price), 0);\n  };\n\n  const formatTime = (dateString) => {\n    return new Date(dateString).toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-sangeet-neutral-950 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-sangeet-400 mx-auto mb-4\"></div>\n          <p className=\"text-sangeet-neutral-300\">Loading your order details...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !order) {\n    return (\n      <div className=\"min-h-screen bg-sangeet-neutral-950 flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto px-4\">\n          <div className=\"text-6xl mb-4\">üîç</div>\n          <h1 className=\"text-2xl font-bold text-sangeet-400 mb-4\">Order Not Found</h1>\n          <p className=\"text-sangeet-neutral-300 mb-6\">\n            {error || 'Unable to find the order you\\'re looking for. Please check your order ID and try again.'}\n          </p>\n          <button\n            onClick={() => navigate('/')}\n            className=\"bg-sangeet-400 text-sangeet-neutral-950 px-6 py-3 rounded-lg font-semibold hover:bg-sangeet-300 transition-colors\"\n          >\n            Back to Home\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  const currentStatus = orderStatuses[order.status] || orderStatuses.pending;\n  const statusStep = getStatusStep(order.status);\n\n  return (\n    <div className=\"min-h-screen bg-sangeet-neutral-950 py-8 px-4\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"text-center mb-8\"\n        >\n          <h1 className=\"text-3xl md:text-4xl font-bold text-sangeet-400 mb-4\">\n            Track Your Order\n          </h1>\n          <p className=\"text-sangeet-neutral-300 text-lg\">\n            Order #{order.order_number || order.id}\n          </p>\n        </motion.div>\n\n        {/* Order Status Card */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.1 }}\n          className=\"bg-gradient-to-r from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 md:p-8 shadow-2xl border border-sangeet-neutral-700 mb-8\"\n        >\n          {/* Current Status */}\n          <div className=\"text-center mb-8\">\n            <div className={`inline-flex items-center justify-center w-20 h-20 rounded-full ${currentStatus.bgColor} ${currentStatus.borderColor} border-2 mb-4`}>\n              <span className=\"text-3xl\">{currentStatus.icon}</span>\n            </div>\n            <h2 className={`text-2xl font-bold ${currentStatus.color} mb-2`}>\n              {currentStatus.label}\n            </h2>\n            <p className=\"text-sangeet-neutral-300\">\n              {currentStatus.description}\n            </p>\n          </div>\n\n          {/* Progress Steps */}\n          <div className=\"mb-8\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-semibold text-sangeet-neutral-200\">Order Progress</h3>\n              <span className=\"text-sm text-sangeet-neutral-400\">\n                {order.status === 'cancelled' ? 'Order Cancelled' : `Step ${statusStep} of 4`}\n              </span>\n            </div>\n            \n            {order.status === 'cancelled' ? (\n              /* Cancelled Order Display */\n              <div className=\"text-center py-8\">\n                <div className=\"w-16 h-16 rounded-full bg-red-500/20 border-2 border-red-500/30 flex items-center justify-center mx-auto mb-4\">\n                  <span className=\"text-3xl\">‚ùå</span>\n                </div>\n                <h3 className=\"text-xl font-bold text-red-400 mb-2\">Order Cancelled</h3>\n                <p className=\"text-sangeet-neutral-300 mb-4\">\n                  Your order has been cancelled by the restaurant\n                </p>\n                            <div className=\"bg-red-500/10 border border-red-500/30 rounded-lg p-4\">\n              <p className=\"text-red-300 text-sm mb-3\">\n                üí¨ Please contact restaurant staff for refund assistance\n              </p>\n              <div className=\"flex items-center justify-center space-x-2 mb-4\">\n                <div className=\"w-2 h-2 bg-red-400 rounded-full animate-pulse\"></div>\n                <p className=\"text-red-300 text-xs\">\n                  Auto fresh start in 5 minutes or click Start Fresh\n                </p>\n              </div>\n              <button\n                onClick={() => {\n                  // Clear any stored cart data\n                  localStorage.removeItem('cart');\n                  localStorage.removeItem('customerSession');\n                  localStorage.removeItem('sessionTimestamp');\n                  \n                  // Redirect to QR menu page for fresh start\n                  navigate('/');\n                  \n                  // Show fresh start message\n                  toast.success('Fresh start! Scan QR code to begin new order üçΩÔ∏è', {\n                    duration: 4000,\n                    icon: 'üîÑ'\n                  });\n                }}\n                className=\"w-full bg-sangeet-400 text-sangeet-neutral-950 px-4 py-2 rounded-lg font-semibold hover:bg-sangeet-300 transition-colors text-sm\"\n              >\n                üîÑ Start Fresh\n              </button>\n            </div>\n              </div>\n            ) : (\n              /* Normal Progress Bar */\n              <div className=\"relative\">\n                {/* Progress Bar */}\n                <div className=\"absolute top-4 left-0 right-0 h-1 bg-sangeet-neutral-700 rounded-full\">\n                  <div \n                    className=\"h-1 bg-gradient-to-r from-sangeet-400 to-sangeet-500 rounded-full transition-all duration-1000\"\n                    style={{ width: `${(statusStep / 4) * 100}%` }}\n                  ></div>\n                </div>\n                \n                {/* Status Steps */}\n                <div className=\"relative flex justify-between\">\n                  {Object.entries(orderStatuses).filter(([status]) => status !== 'cancelled').map(([status, config], index) => {\n                    const isCompleted = getStatusStep(status) <= statusStep;\n                    const isCurrent = status === order.status;\n                    \n                    return (\n                      <div key={status} className=\"flex flex-col items-center\">\n                        <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${\n                          isCompleted \n                            ? 'bg-sangeet-400 text-sangeet-neutral-950' \n                            : 'bg-sangeet-neutral-700 text-sangeet-neutral-400'\n                        }`}>\n                          {isCompleted ? '‚úì' : index + 1}\n                        </div>\n                        <div className=\"mt-2 text-center\">\n                          <p className={`text-xs font-medium ${isCurrent ? currentStatus.color : 'text-sangeet-neutral-400'}`}>\n                            {config.label}\n                          </p>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Estimated Time */}\n          <div className=\"bg-sangeet-neutral-800/50 rounded-xl p-4 text-center\">\n            <p className=\"text-sangeet-neutral-300 mb-1\">Estimated Completion</p>\n            <p className=\"text-lg font-semibold text-sangeet-400\">\n              {order.status === 'completed' ? 'Order Completed' : '15-20 minutes'}\n            </p>\n          </div>\n        </motion.div>\n\n        {/* Order Details */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.2 }}\n          className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\"\n        >\n          {/* Order Information */}\n          <div className=\"bg-gradient-to-r from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 shadow-2xl border border-sangeet-neutral-700\">\n            <h3 className=\"text-xl font-bold text-sangeet-400 mb-4 flex items-center\">\n              <span className=\"mr-2\">üìã</span>\n              Order Information\n            </h3>\n            \n            <div className=\"space-y-3\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-sangeet-neutral-400\">Order Number:</span>\n                <span className=\"text-sangeet-neutral-200 font-semibold\">\n                  #{order.order_number || order.id}\n                </span>\n              </div>\n              \n              <div className=\"flex justify-between\">\n                <span className=\"text-sangeet-neutral-400\">Customer:</span>\n                <span className=\"text-sangeet-neutral-200 font-semibold\">\n                  {order.customer_name}\n                </span>\n              </div>\n              \n              <div className=\"flex justify-between\">\n                <span className=\"text-sangeet-neutral-400\">Table:</span>\n                <span className=\"text-sangeet-neutral-200 font-semibold\">\n                  {order.table_number || 'N/A'}\n                </span>\n              </div>\n              \n              <div className=\"flex justify-between\">\n                <span className=\"text-sangeet-neutral-400\">Order Time:</span>\n                <span className=\"text-sangeet-neutral-200 font-semibold\">\n                  {formatTime(order.created_at)}\n                </span>\n              </div>\n              \n              <div className=\"flex justify-between\">\n                <span className=\"text-sangeet-neutral-400\">Date:</span>\n                <span className=\"text-sangeet-neutral-200 font-semibold\">\n                  {formatDate(order.created_at)}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Order Items */}\n          <div className=\"bg-gradient-to-r from-sangeet-neutral-900 to-sangeet-neutral-800 rounded-2xl p-6 shadow-2xl border border-sangeet-neutral-700\">\n            <h3 className=\"text-xl font-bold text-sangeet-400 mb-4 flex items-center\">\n              <span className=\"mr-2\">üçΩÔ∏è</span>\n              Order Items\n            </h3>\n            \n            <div className=\"space-y-3\">\n              {order.items?.map((item, index) => (\n                <div key={index} className=\"flex justify-between items-center py-2 border-b border-sangeet-neutral-700 last:border-b-0\">\n                  <div className=\"flex-1\">\n                    <p className=\"text-sangeet-neutral-200 font-medium\">{item.name}</p>\n                    <p className=\"text-sm text-sangeet-neutral-400\">\n                      Qty: {item.quantity} √ó ${parseFloat(item.unit_price).toFixed(2)}\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sangeet-neutral-200 font-semibold\">\n                      ${parseFloat(item.total_price).toFixed(2)}\n                    </p>\n                  </div>\n                </div>\n              ))}\n              \n              <div className=\"pt-3 border-t border-sangeet-neutral-600\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-lg font-semibold text-sangeet-neutral-200\">Total</span>\n                  <span className=\"text-xl font-bold text-sangeet-400\">\n                    ${getTotalAmount().toFixed(2)}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Action Buttons */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.3 }}\n          className=\"flex flex-col sm:flex-row gap-4 justify-center mt-8\"\n        >\n          <button\n            onClick={() => navigate('/')}\n            className=\"bg-sangeet-neutral-700 hover:bg-sangeet-neutral-600 text-sangeet-neutral-200 px-6 py-3 rounded-xl font-semibold transition-colors\"\n          >\n            Back to Home\n          </button>\n          \n          <button\n            onClick={() => navigate('/menu')}\n            className=\"bg-sangeet-400 hover:bg-sangeet-300 text-sangeet-neutral-950 px-6 py-3 rounded-xl font-semibold transition-colors\"\n          >\n            Order More Food\n          </button>\n        </motion.div>\n\n        {/* Review Section - Show when order is ready or completed */}\n        {(order.status === 'ready' || order.status === 'completed') && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.4 }}\n            className=\"mt-8 bg-gradient-to-r from-yellow-900/20 to-orange-900/20 rounded-2xl p-6 border border-yellow-500/30\"\n          >\n            <div className=\"text-center\">\n              <div className=\"text-3xl mb-3\">‚≠ê</div>\n              <h3 className=\"text-lg font-semibold text-yellow-400 mb-2\">\n                How was your dining experience?\n              </h3>\n              <p className=\"text-sangeet-neutral-300 mb-4\">\n                We'd love to hear about your meal! Your feedback helps us improve and serve you better.\n              </p>\n                             <button\n                 onClick={() => window.location.href = `/review?orderId=${orderId}&table=${order.table_number}&customerName=${encodeURIComponent(order.customer_name)}`}\n                 className=\"bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-300 hover:to-orange-400 text-sangeet-neutral-950 py-3 px-6 rounded-lg font-semibold transition-all duration-300 shadow-lg hover:shadow-xl\"\n               >\n                 Share Your Experience\n               </button>\n            </div>\n          </motion.div>\n        )}\n\n        {/* Auto-refresh notice */}\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ delay: 0.4 }}\n          className=\"text-center mt-6\"\n        >\n          <p className=\"text-sm text-sangeet-neutral-400\">\n            üîÑ This page automatically updates every 30 seconds\n          </p>\n        </motion.div>\n      </div>\n    </div>\n  );\n};\n\nexport default OrderTrackingPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}